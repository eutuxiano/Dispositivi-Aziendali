@model IEnumerable<DeviceManagerMVC.Models.Device>

@{
    ViewData["Title"] = "Devices";
}

<h2>Gestione Dispositivi</h2>

<form id="searchForm" class="mb-3">
    <div class="input-group">
        <input type="text" id="searchInput" name="search" class="form-control" placeholder="Cerca in tutti i campi..." />
        <button type="submit" class="btn btn-primary">Cerca</button>
    </div>
</form>

<div class="mb-3">
    <a class="btn btn-success" asp-action="Create">Crea nuovo dispositivo</a>
    <a class="btn btn-secondary" asp-action="ImportCsv">Importa CSV</a>
    <a class="btn btn-info" asp-action="ExportCsv">Esporta CSV</a>
</div>


<div id="results">
    <!-- Qui verrà caricata la tabella via AJAX -->
</div>

@section Scripts {
    <script>
        function loadResults(page = 1) {
            const search = document.getElementById("searchInput").value;

            $.ajax({
                url: '/Devices/SearchAjax',
                type: 'GET',
                data: { search: search, page: page },
                success: function (data) {
                    $("#results").html(data);
                }
            });
        }

        // Submit del form
        $("#searchForm").on("submit", function (e) {
            e.preventDefault();
            loadResults(1);
        });

        // Carica la prima pagina all'avvio
        $(document).ready(function () {
            loadResults(1);
        });
    </script>
}


