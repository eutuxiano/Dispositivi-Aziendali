@{
    ViewData["Title"] = "Devices";
}

<div class="text-center mt-4 mb-3"> <h2 class="fw-semibold">Gestione Dispositivi</h2>
    </div>

<form id="searchForm" class="mb-3" onsubmit="return false;">
    <div class="input-group">
        <input type="text" id="searchInput" name="search" class="form-control" placeholder="Cerca in tutti i campi..." />
        <button type="submit" class="btn btn-primary">Cerca</button>
    </div>
</form>

<div class="text-center mb-3">

    <div class="d-inline-flex gap-2">
        <a class="btn btn-success" asp-action="Create">Crea nuovo dispositivo</a>
        <a class="btn btn-secondary" asp-action="ImportCsv">Importa CSV</a>
        <a class="btn btn-info" asp-action="ExportCsv">Esporta CSV</a>
    </div>

</div>



<div id="results">
    <!-- Qui verrà caricata la tabella via AJAX -->
</div>

@section Scripts {
    <script>
        function loadResults(page = 1) {
            const search = document.getElementById("searchInput").value;

                    $.ajax({
            url: '/Devices/SearchAjax',
            type: 'GET',
            data: {
                search: search,
                page: page
            },
            success: function (data) {
                $("#results").html(data);
            },
            error: function (xhr) {
                console.error("Errore AJAX:", xhr.status, xhr.responseText);
            }
        });

        }

        // Submit del form
                document.getElementById("searchForm").addEventListener("submit", function (e) {
            e.preventDefault();
            loadResults(1);
        });


        // Carica la prima pagina all'avvio
        $(document).ready(function () {
            loadResults(1);
        });
    </script>
}


